<html>
	<head>
		<script>
			vals = [
					{"name":'Мужчина главный', "code":"1125-1131-1355"}, 
					{"name":'Религиозоные правила', "code":"4535-4211-1153"},
					{"name":'Романтическая любовь', "code":"1554-1211-1144"},
					{"name":'Механизм сожительства', "code":"5414-1321-2233"},
					{"name":'Новая женщина', "code":"2533-2234-1311"},
					{"name":'Плейбой и пикап', "code":"4431-1254-1455"},
					{"name":'ЛГБТ отношения', "code":"5445-4415-5123"},
					{"name":'Свингерство', "code":"2555-2435-2422"},
					{"name":'Открытые отношения', "code":"5535-4523-2451"},
					{"name":'Полиамория иерархическая', "code":"5245-4435-4551"},
					{"name":'Полиамория равноправная', "code":"5245-5435-4511"},
					{"name":'Соло Полиамория', "code":"5245-1355-4531"},
					{"name":'Анархия отношений', "code":"5433-3434-5411"}					
				];

			function clickSliders(in_ind) { // console.log(in_code);						
				document.querySelector("select").selectedIndex = in_ind+2+ Math.round(in_ind)/4;
				if (in_ind > 0) chngSliders(vals[in_ind].code);
					else chngSliders("3333-3333-3333");
				
			}	
			function chngSliders(in_code) { // console.log(in_code);
				document.getElementById("varsort").innerHTML = "&nbsp;";
				var icode = in_code.replace(/-/g, '');
				for (var i=1; i<13; i++) {
					document.getElementById('s'+i).value = icode[i-1];
				
				}
			};
			function chngType() { 
				var sumval = 0;
				document.querySelector("select").selectedIndex = 0;

				var difar = Array();

				for (var i=0, n=vals.length;i<n;i++) { 
					var tmpcode = vals[i].code.replace(/-/g, '');
					var sumdif = 0;
					for (var j=1; j<13; j++) sumdif = sumdif + Math.abs(document.getElementById('s'+j).value - tmpcode[j-1]);
					difar[i] = sumdif;
					//document.getElementById('s'+i).value = icode[i-1]-3;
					
				}
				var difkey = Array();	
				for (var i = 0; i < difar.length; ++i) difkey[i] = i;
				difkey.sort(function (a, b) { return difar[a] < difar[b] ? -1 : difar[a] > difar[b] ? 1 : 0; });
			
			//	console.log("слайдер  = "+ difar+ ": "+difkey);


				document.getElementById("varsort").innerHTML = "<a href='#' onclick='clickSliders("+difkey[0]+")'>"+vals[difkey[0]].name+ "</a> "+ Math.round(1000 - 1000*difar[difkey[0]]/48)/10 + "%, <a href='#' onclick='clickSliders("+difkey[1]+")'>"+vals[difkey[1]].name+ "</a> "+ Math.round(1000 - 1000*difar[difkey[1]]/48)/10 + "%, <a href='#' onclick='clickSliders("+difkey[2]+")'>"+vals[difkey[2]].name+ "</a> "+ Math.round(1000 - 1000*difar[difkey[2]]/48)/10 + "%";	
				
							};			
			function script() {

				var sel = document.querySelector("select");
				for (var i=0, n=vals.length;i<n;i++) { // looping over the options
					  if (i%4 == 0) { 
						var optn2 = document.createElement("OPTION");
					    optn2.text = '___________________________';
					    optn2.disabled = true;
					    sel.options.add(optn2);
					  }
					  var optn = document.createElement("OPTION");
					    optn.text = vals[i].name;
					    optn.value = vals[i].code;
					    sel.options.add(optn);
				  
				  //sel.options[i].value = vals[i];
				  }
			
			}
		</script>
		<style>
			.tbl { width: 440px;}
			.tg-0lax { width: 180px;}
			.tg-0la { width: 120px;}
			input { width: 90px;}
			#varsort {font-size: 70%;}
		</style>
	</head>

<body onload="script();" style="padding: 20px; background-color: gray; font-family: sans-serif">
<div style=" background-color: white; padding: 40px; width: 450px; margin: 0 auto">
	<div><label for="c-1-6">Отношения</label>
	<select onchange="chngSliders(this.value);">
		<option selected="selected" value="3333-3333-3333">выбери тип...</option>
	</select> <a href='#' onclick='clickSliders(-1)'>X</a></div>
<div id="varsort">&nbsp;</div>


<form onsubmit="return false">
<br/>
	<table class="tbl"><tr>
	    <td class="tg-0lax">Течение<br/>Повседневность<br/>Рациональные<br/>Краткосрочные</td>
	    <td class="tg-0la"><input onchange="chngType();" name="slider11" id="s1" type="range" min="1" max="5" value="3"><br/><input onchange="chngType();" name="slider12" id="s2" type="range" min="1" max="5" value="3"><br/><input onchange="chngType();" name="slider13" id="s3" type="range" min="1" max="5" value="3"> <br/><input onchange="chngType();" name="slider14" id="s4" type="range" min="1" max="5" value="3"></td>
	    <td class="tg-0lax">Настройка<br/>Идейность<br/>Чувственные<br/>Долгосрочные</td>
  </tr></table>
<br/>
	<table class="tbl"><tr>
	    <td class="tg-0lax">Индивидуализм<br/>Внутрь<br/>Сближение<br/>Приемлемые</td>
	    <td class="tg-0la"><input onchange="chngType();" name="slider21" id="s5" type="range" min="1" max="5" value="3"><br/><input onchange="chngType();" name="slider22" id="s6" type="range" min="1" max="5" value="3"><br/><input onchange="chngType();" name="slider23" id="s7" type="range" min="1" max="5" value="3"> <br/><input onchange="chngType();" name="slider24" id="s8" type="range" min="1" max="5" value="3"></td>
	    <td class="tg-0lax">Коллективизм<br/>Вовне<br/>Дистанция<br/>Протестные</td>
  </tr></table>
<br/>
	<table class="tbl"><tr>
	    <td class="tg-0lax">Две роли<br/>Эксклюзивные<br/>Равноправные<br/>Женщина-деятель</td>
	    <td class="tg-0la"><input onchange="chngType();" name="slider31" id="s9" type="range" min="1" max="5" value="3"><br/><input onchange="chngType();" name="slider32" id="s10" type="range" min="1" max="5" value="3"><br/><input onchange="chngType();" name="slider33" id="s11" type="range" min="1" max="5" value="3"> <br/><input onchange="chngType();" name="slider34" id="s12" type="range" min="1" max="5" value="3"></td>
	    <td class="tg-0lax">Множественность<br/>Не эксклюзивные<br/>Иерархические<br/>Женщина-имущество</td>
  </tr></table>	
</form>
</div>
</body></html>